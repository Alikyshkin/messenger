import 'package:flutter/material.dart';
import 'package:provider/provider.dart';
import '../services/locale_service.dart';

class AppLocalizations {
  AppLocalizations._();

  static Locale _locale(BuildContext context) {
    return context.watch<LocaleService>().locale ?? const Locale('ru');
  }

  static String tr(BuildContext context, String key) {
    final locale = _locale(context);
    final map = locale.languageCode == 'en' ? _en : _ru;
    return map[key] ?? _ru[key] ?? key;
  }

  static const Map<String, String> _ru = {
    'loading': 'Загрузка...',
    'messenger': 'Мессенджер',
    'settings': 'Настройки',
    'save': 'Сохранить',
    'back': 'Назад',
    'cancel': 'Отмена',
    'delete': 'Удалить',
    'dark_theme': 'Тёмная тема',
    'dark_theme_subtitle': 'Включить тёмный режим',
    'language': 'Язык',
    'language_ru': 'Русский',
    'language_en': 'English',
    'appearance': 'Внешний вид',
    'theme_light': 'Светлая',
    'theme_dark': 'Тёмная',
    'theme_system': 'Как в системе',
    'danger_zone': 'Опасная зона',
    'not_authorized': 'Не авторизован',
    'tap_to_change_photo': 'Нажмите, чтобы сменить фото',
    'display_name_label': 'Имя (как отображается)',
    'display_name_hint': 'Имя',
    'username_label': 'Имя пользователя (@username)',
    'username_hint': 'логин',
    'username_helper': 'По нему вас находят и добавляют в друзья',
    'bio_label': 'О себе',
    'bio_hint': 'Краткое описание профиля',
    'email_label': 'Эл. почта',
    'email_hint_recovery': 'Для восстановления пароля',
    'phone': 'Телефон',
    'phone_label': 'Номер телефона',
    'phone_hint': '+7 900 123-45-67',
    'phone_helper': 'Для синхронизации контактов и поиска друзей',
    'birthday': 'День рождения',
    'birthday_not_set': 'Не указан',
    'birthday_help': 'День рождения',
    'reset': 'Сбросить',
    'pick_date': 'Выбрать дату',
    'change_password_section': 'Изменить пароль',
    'current_password': 'Текущий пароль',
    'new_password': 'Новый пароль (мин. 6 символов)',
    'confirm_password': 'Повторите новый пароль',
    'change_password_btn': 'Изменить пароль',
    'cache_section': 'Кэш вложений',
    'cache_description':
        'Скачанные файлы, голосовые и видео хранятся в полноразмерном виде на устройстве.',
    'clear_cache_by_chat': 'Очистить по чату',
    'clear_all_cache': 'Очистить весь кэш',
    'clear_all_chats_messages': 'Очистить все чаты и сообщения',
    'clear_all_chats_messages_title': 'Очистить все чаты?',
    'clear_all_chats_messages_body':
        'Все чаты и сообщения будут удалены из локального кэша. Данные на сервере сохранятся.',
    'account_section': 'Аккаунт',
    'delete_account': 'Удалить аккаунт',
    'delete_account_confirm_title': 'Удалить аккаунт?',
    'delete_account_confirm_body':
        'Аккаунт и все данные (чаты, сообщения, контакты) будут удалены безвозвратно. Выйти?',
    'profile_saved': 'Профиль сохранён',
    'photo_updated': 'Фото обновлено',
    'password_changed': 'Пароль изменён',
    'enter_current_password': 'Введите текущий пароль',
    'new_password_min': 'Новый пароль минимум 6 символов',
    'passwords_dont_match': 'Пароли не совпадают',
    'connection_error': 'Ошибка соединения',
    'save_error': 'Ошибка сохранения',
    'upload_photo_error': 'Ошибка загрузки фото',
    'account_deleted': 'Аккаунт удалён',
    'clear_cache_for_chat_title': 'Очистить кэш вложений для чата',
    'cache_cleared_for': 'Кэш для %s очищен',
    'all_cache_cleared': 'Весь кэш вложений очищен',
    'login': 'Вход',
    'username': 'Имя пользователя',
    'password': 'Пароль',
    'enter_username': 'Введите имя',
    'enter_password': 'Введите пароль',
    'login_btn': 'Войти',
    'forgot_password': 'Забыли пароль?',
    'no_account_register': 'Нет аккаунта? Зарегистрироваться',
    'or_login_with': 'Или войти с помощью',
    'oauth_not_configured': 'Этот способ входа не настроен на сервере',
    'login_with_phone': 'Вход по телефону',
    'enter_phone': 'Введите номер телефона',
    'send_code': 'Отправить код',
    'code': 'Код',
    'enter_code_6': 'Введите 6-значный код',
    'code_sent_to': 'Код отправлен на',
    'resend_code': 'Отправить код повторно',
    'forgot_password_title': 'Восстановление пароля',
    'back_to_login': 'Вернуться ко входу',
    'send_reset_link': 'Отправить ссылку',
    'register_title': 'Регистрация',
    'create_account': 'Создать аккаунт',
    'chats': 'Чаты',
    'retry': 'Повторить',
    'profile': 'Профиль',
    'friends': 'Друзья',
    'settings_subtitle': 'Имя, username, фото, описание',
    'logout': 'Выйти',
    'logout_confirm': 'Выйти?',
    'contacts': 'Друзья',
    'possible_friends': 'Возможные друзья',
    'sync_contacts': 'Синхронизировать контакты',
    'add': 'Добавить',
    'reject': 'Отклонить',
    'accept': 'Принять',
    'remove_friend_title': 'Удалить из друзей?',
    'remove_friend_body': 'Удалить %s из друзей?',
    'delete_chat': 'Удалить чат',
    'delete_chat_title': 'Удалить чат?',
    'delete_chat_message':
        'Чат с %s будет удалён из списка. Сообщения останутся на сервере.',
    'new_chat': 'Новый чат',
    'search_hint': 'Введите имя и нажмите поиск',
    'add_friend': 'Добавить друга',
    'request_sent': 'Заявка отправлена. Можете написать сообщение.',
    'reply': 'Ответить',
    'forward': 'Переслать',
    'forward_to_chat': 'Переслать в чат',
    'chats_load_error': 'Ошибка загрузки чатов',
    'no_chats_to_forward': 'Нет других чатов для пересылки',
    'forward_text_only': 'Переслать можно только текстовые сообщения',
    'forwarded_to': 'Переслано в чат с %s',
    'no_connection_message':
        'Нет связи. Сообщение будет отправлено при появлении сети.',
    'no_mic': 'Нет доступа к микрофону',
    'poll': 'Опрос',
    'open_file_error': 'Не удалось открыть файл',
    'new_poll': 'Новый опрос',
    'add_option': 'Добавить вариант',
    'multiple_choices': 'Несколько вариантов',
    'poll_question_and_options': 'Введите вопрос и минимум 2 варианта',
    'create': 'Создать',
    'contacts_permission': 'Нужен доступ к контактам для поиска друзей',
    'no_phones_in_contacts': 'В контактах нет номеров телефонов',
    'request_sent_to': 'Заявка %s отправлена',
    'write': 'Написать',
    'video_note': 'Видеокружок',
    'close': 'Закрыть',
    'got_it': 'Понятно',
    'download': 'Скачать',
    'file_load_error': 'Не удалось загрузить файл',
    'saved': 'Сохранено',
    'save_error_file': 'Не удалось сохранить',
    'calling': 'Вызов...',
    'incoming_call': 'Входящий звонок',
    'video_call': 'Видеозвонок',
    'audio_call': 'Аудиозвонок',
    'jan': 'января',
    'feb': 'февраля',
    'mar': 'марта',
    'apr': 'апреля',
    'may': 'мая',
    'jun': 'июня',
    'jul': 'июля',
    'aug': 'августа',
    'sep': 'сентября',
    'oct': 'октября',
    'nov': 'ноября',
    'dec': 'декабря',
    'display_name_optional': 'Отображаемое имя (необязательно)',
    'email_for_recovery': 'Email (для восстановления пароля)',
    'min_3_chars': 'Минимум 3 символа',
    'forgot_email_sent':
        'Если аккаунт с таким email есть, на него отправлена ссылка для сброса пароля. Проверьте почту и перейдите по ссылке.',
    'forgot_email_prompt':
        'Введите email, указанный при регистрации. Мы отправим ссылку для сброса пароля.',
    'enter_email': 'Введите email',
    'email_hint_example': 'пример@mail.ru',
    'min_6_chars': 'Минимум 6 символов',
    'load_error': 'Ошибка загрузки',
    'no_chats': 'Нет чатов.\nДобавьте контакт и напишите ему.',
    'my_profile': 'Мой профиль',
    'no_friends': 'Нет друзей',
    'one_friend': '1 друг',
    'friends_2_4': '%s друга',
    'friends_5_plus': '%s друзей',
    'message': 'Сообщение',
    'you_prefix': 'Вы: ',
    'poll_prefix': 'Опрос: ',
    'add_by_username': 'Добавить по username',
    'error': 'Ошибка',
    'no_friends_add_hint':
        'Нет друзей.\nНажмите + чтобы добавить или отправить заявку.',
    'friend_requests': 'Заявки в друзья',
    'possible_friends_subtitle':
        'Контакты из телефона, зарегистрированные в мессенджере',
    'remove_friend_tooltip': 'Удалить из друзей',
    'online': 'в сети',
    'last_seen_just_now': 'был(а) только что',
    'last_seen_minutes': 'был(а) %s мин. назад',
    'last_seen_hours': 'был(а) %s ч. назад',
    'last_seen_today': 'был(а) сегодня в %s',
    'last_seen_yesterday': 'был(а) вчера',
    'last_seen_long_ago': 'был(а) давно',
    'typing': '%s печатает',
    'typing_plural': '%s печатают',
    'delete_for_me': 'Удалить для себя',
    'delete_for_all': 'Удалить для всех',
    'block_user': 'Заблокировать',
    'unblock_user': 'Разблокировать',
    'mute_chat': 'Отключить уведомления',
    'unmute_chat': 'Включить уведомления',
    'pin_chat': 'Закрепить',
    'unpin_chat': 'Открепить',
    'search_in_chats': 'Поиск по чатам',
    'search_in_chats_hint': 'Поиск сообщений...',
    'search_in_chats_enter_query': 'Введите минимум 2 символа для поиска',
    'search_no_results': 'Ничего не найдено',
    'search_filter_all': 'Все',
    'search_filter_text': 'Текст',
    'search_filter_image': 'Фото',
    'search_filter_video': 'Видео',
    'search_filter_file': 'Файлы',
    'search_filter_voice': 'Голос',
    'search_filter_link': 'Ссылки',
    'privacy_section': 'Приватность',
    'privacy_who_can_see_status': 'Кто видит статус «был(а) в сети»',
    'privacy_who_can_message': 'Кто может писать сообщения',
    'privacy_who_can_call': 'Кто может звонить',
    'privacy_all': 'Все',
    'privacy_contacts': 'Только контакты',
    'privacy_nobody': 'Никто',
    'privacy_hide_status': 'Скрыть статус',
    'privacy_show_status': 'Показать статус',
    'profile_tooltip': 'Профиль',
    'zero_friends': '0 друзей',
    'possible_friends_empty':
        'Добавьте номер телефона в профиль и включите доступ к контактам.\nНажмите «Синхронизировать», чтобы найти друзей из контактов.',
    'new_group': 'Новая группа',
    'create_group': 'Создать группу',
    'group_name': 'Название группы',
    'group_name_hint': 'Введите название',
    'group_photo': 'Фото группы',
    'tap_to_set_photo': 'Нажмите, чтобы задать фото',
    'members_count': 'Участников: %s',
    'group_call': 'Групповой звонок',
    'group_call_coming':
        'Групповой видеозвонок будет доступен в следующей версии',
    'leave_group': 'Выйти из группы',
    'leave_group_confirm': 'Выйти из группы?',
    'select_at_least_one_member': 'Выберите хотя бы одного участника',
    'participants': 'Участники',
  };

  static const Map<String, String> _en = {
    'loading': 'Loading...',
    'messenger': 'Messenger',
    'settings': 'Settings',
    'save': 'Save',
    'back': 'Back',
    'cancel': 'Cancel',
    'delete': 'Delete',
    'dark_theme': 'Dark theme',
    'dark_theme_subtitle': 'Enable dark mode',
    'language': 'Language',
    'language_ru': 'Русский',
    'language_en': 'English',
    'appearance': 'Appearance',
    'theme_light': 'Light',
    'theme_dark': 'Dark',
    'theme_system': 'System',
    'danger_zone': 'Danger zone',
    'not_authorized': 'Not authorized',
    'tap_to_change_photo': 'Tap to change photo',
    'display_name_label': 'Display name',
    'display_name_hint': 'Name',
    'username_label': 'Username (@username)',
    'username_hint': 'username',
    'username_helper': 'How others find and add you',
    'bio_label': 'About',
    'bio_hint': 'Short profile description',
    'email_label': 'Email',
    'email_hint_recovery': 'For password recovery',
    'phone': 'Phone',
    'phone_label': 'Phone number',
    'phone_hint': '+1 234 567-89-00',
    'phone_helper': 'To sync contacts and find friends',
    'birthday': 'Birthday',
    'birthday_not_set': 'Not set',
    'birthday_help': 'Birthday',
    'reset': 'Clear',
    'pick_date': 'Pick date',
    'change_password_section': 'Change password',
    'current_password': 'Current password',
    'new_password': 'New password (min. 6 characters)',
    'confirm_password': 'Confirm new password',
    'change_password_btn': 'Change password',
    'cache_section': 'Attachment cache',
    'cache_description':
        'Downloaded files, voice and video are stored in full size on device.',
    'clear_cache_by_chat': 'Clear by chat',
    'clear_all_cache': 'Clear all cache',
    'clear_all_chats_messages': 'Clear all chats and messages',
    'clear_all_chats_messages_title': 'Clear all chats?',
    'clear_all_chats_messages_body':
        'All chats and messages will be removed from local cache. Server data will be preserved.',
    'account_section': 'Account',
    'delete_account': 'Delete account',
    'delete_account_confirm_title': 'Delete account?',
    'delete_account_confirm_body':
        'Account and all data (chats, messages, contacts) will be permanently deleted. Continue?',
    'profile_saved': 'Profile saved',
    'photo_updated': 'Photo updated',
    'password_changed': 'Password changed',
    'enter_current_password': 'Enter current password',
    'new_password_min': 'New password must be at least 6 characters',
    'passwords_dont_match': 'Passwords do not match',
    'connection_error': 'Connection error',
    'save_error': 'Save error',
    'upload_photo_error': 'Photo upload error',
    'account_deleted': 'Account deleted',
    'clear_cache_for_chat_title': 'Clear attachment cache for chat',
    'cache_cleared_for': 'Cache cleared for %s',
    'all_cache_cleared': 'All attachment cache cleared',
    'login': 'Login',
    'username': 'Username',
    'password': 'Password',
    'enter_username': 'Enter username',
    'enter_password': 'Enter password',
    'login_btn': 'Log in',
    'forgot_password': 'Forgot password?',
    'no_account_register': 'No account? Sign up',
    'or_login_with': 'Or sign in with',
    'oauth_not_configured': 'This sign-in method is not configured on the server',
    'login_with_phone': 'Sign in with phone',
    'enter_phone': 'Enter phone number',
    'send_code': 'Send code',
    'code': 'Code',
    'enter_code_6': 'Enter 6-digit code',
    'code_sent_to': 'Code sent to',
    'resend_code': 'Resend code',
    'forgot_password_title': 'Password recovery',
    'back_to_login': 'Back to login',
    'send_reset_link': 'Send reset link',
    'register_title': 'Sign up',
    'create_account': 'Create account',
    'chats': 'Chats',
    'retry': 'Retry',
    'profile': 'Profile',
    'friends': 'Friends',
    'settings_subtitle': 'Name, username, photo, bio',
    'logout': 'Log out',
    'logout_confirm': 'Log out?',
    'contacts': 'Friends',
    'possible_friends': 'Suggested friends',
    'sync_contacts': 'Sync contacts',
    'add': 'Add',
    'reject': 'Reject',
    'accept': 'Accept',
    'remove_friend_title': 'Remove from friends?',
    'remove_friend_body': 'Remove %s from friends?',
    'delete_chat': 'Delete chat',
    'delete_chat_title': 'Delete chat?',
    'delete_chat_message':
        'Chat with %s will be removed from the list. Messages will remain on the server.',
    'new_chat': 'New chat',
    'search_hint': 'Enter name and search',
    'add_friend': 'Add friend',
    'request_sent': 'Request sent. You can send a message.',
    'reply': 'Reply',
    'forward': 'Forward',
    'forward_to_chat': 'Forward to chat',
    'chats_load_error': 'Error loading chats',
    'no_chats_to_forward': 'No other chats to forward to',
    'forward_text_only': 'Only text messages can be forwarded',
    'forwarded_to': 'Forwarded to chat with %s',
    'no_connection_message': 'No connection. Message will be sent when online.',
    'no_mic': 'No microphone access',
    'poll': 'Poll',
    'open_file_error': 'Could not open file',
    'new_poll': 'New poll',
    'add_option': 'Add option',
    'multiple_choices': 'Multiple choice',
    'poll_question_and_options': 'Enter question and at least 2 options',
    'create': 'Create',
    'contacts_permission': 'Contacts access needed to find friends',
    'no_phones_in_contacts': 'No phone numbers in contacts',
    'request_sent_to': 'Request to %s sent',
    'write': 'Message',
    'video_note': 'Video note',
    'close': 'Close',
    'got_it': 'Got it',
    'download': 'Download',
    'file_load_error': 'Could not load file',
    'saved': 'Saved',
    'save_error_file': 'Could not save',
    'calling': 'Calling...',
    'incoming_call': 'Incoming call',
    'video_call': 'Video call',
    'audio_call': 'Audio call',
    'jan': 'Jan',
    'feb': 'Feb',
    'mar': 'Mar',
    'apr': 'Apr',
    'may': 'May',
    'jun': 'Jun',
    'jul': 'Jul',
    'aug': 'Aug',
    'sep': 'Sep',
    'oct': 'Oct',
    'nov': 'Nov',
    'dec': 'Dec',
    'display_name_optional': 'Display name (optional)',
    'email_for_recovery': 'Email (for password recovery)',
    'min_3_chars': 'At least 3 characters',
    'forgot_email_sent':
        'If an account with this email exists, a reset link has been sent. Check your inbox and follow the link.',
    'forgot_email_prompt':
        'Enter the email you used to register. We will send a password reset link.',
    'enter_email': 'Enter email',
    'email_hint_example': 'example@mail.com',
    'min_6_chars': 'At least 6 characters',
    'load_error': 'Load error',
    'no_chats': 'No chats.\nAdd a contact and send a message.',
    'my_profile': 'My profile',
    'no_friends': 'No friends',
    'one_friend': '1 friend',
    'friends_2_4': '%s friends',
    'friends_5_plus': '%s friends',
    'message': 'Message',
    'you_prefix': 'You: ',
    'poll_prefix': 'Poll: ',
    'add_by_username': 'Add by username',
    'error': 'Error',
    'no_friends_add_hint': 'No friends.\nTap + to add or send a request.',
    'friend_requests': 'Friend requests',
    'possible_friends_subtitle': 'Contacts from your phone who use the app',
    'remove_friend_tooltip': 'Remove from friends',
    'online': 'online',
    'last_seen_just_now': 'last seen just now',
    'last_seen_minutes': 'last seen %s min ago',
    'last_seen_hours': 'last seen %s h ago',
    'last_seen_today': 'last seen today at %s',
    'last_seen_yesterday': 'last seen yesterday',
    'last_seen_long_ago': 'last seen long ago',
    'typing': '%s is typing',
    'typing_plural': '%s are typing',
    'delete_for_me': 'Delete for me',
    'delete_for_all': 'Delete for everyone',
    'block_user': 'Block',
    'unblock_user': 'Unblock',
    'mute_chat': 'Mute notifications',
    'unmute_chat': 'Unmute notifications',
    'pin_chat': 'Pin',
    'unpin_chat': 'Unpin',
    'search_in_chats': 'Search in chats',
    'search_in_chats_hint': 'Search messages...',
    'search_in_chats_enter_query': 'Enter at least 2 characters to search',
    'search_no_results': 'No results found',
    'search_filter_all': 'All',
    'search_filter_text': 'Text',
    'search_filter_image': 'Photos',
    'search_filter_video': 'Video',
    'search_filter_file': 'Files',
    'search_filter_voice': 'Voice',
    'search_filter_link': 'Links',
    'privacy_section': 'Privacy',
    'privacy_who_can_see_status': 'Who can see your online status',
    'privacy_who_can_message': 'Who can send you messages',
    'privacy_who_can_call': 'Who can call you',
    'privacy_all': 'Everyone',
    'privacy_contacts': 'Contacts only',
    'privacy_nobody': 'Nobody',
    'privacy_hide_status': 'Hide my status',
    'privacy_show_status': 'Show my status',
    'profile_tooltip': 'Profile',
    'zero_friends': '0 friends',
    'possible_friends_empty':
        'Add a phone number in your profile and grant contacts access.\nTap «Sync contacts» to find friends from your contacts.',
    'new_group': 'New group',
    'create_group': 'Create group',
    'group_name': 'Group name',
    'group_name_hint': 'Enter name',
    'group_photo': 'Group photo',
    'tap_to_set_photo': 'Tap to set photo',
    'members_count': 'Members: %s',
    'group_call': 'Group call',
    'group_call_coming': 'Group video call coming in a future update',
    'leave_group': 'Leave group',
    'leave_group_confirm': 'Leave group?',
    'select_at_least_one_member': 'Select at least one member',
    'participants': 'Participants',
  };
}

extension AppLocalizationsExtension on BuildContext {
  String tr(String key) => AppLocalizations.tr(this, key);
}
